---

 - hosts: localhost
   become: yes
  

   tasks:

    - name: ensure the jenkins apt repository key is installed

      apt_key: url=https://pkg.jenkins.io/debian-stable/jenkins.io.key state=present

      become: yes



    - name: ensure the repository is configured

      apt_repository: repo='deb https://pkg.jenkins.io/debian-stable binary/' state=present

      become: yes




    - name: Install Java, Jenkins and Maven

      apt:

        name: '{{ packages }}'

        state: present

        update_cache: true

      vars:

        packages:

          - jenkins

          - openjdk-8-jdk

          - maven

    - name: Bypass Setup Wizard

      lineinfile:

        dest: /etc/default/jenkins

        regexp: '^JAVA_ARGS='

        line: 'JAVA_ARGS="-Djava.awt.headless=true -Djenkins.install.runSetupWizard=false"'


    - name: ensure jenkins is restarted and running

      service: name=jenkins state=restarted  
